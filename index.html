<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¡æ“¬æ”å½±è©•åˆ†</title>
    <style>
        /* ------ CSS ç¾åŒ–è¨­å®š (èˆ‡ä¸Šæ¬¡ç›¸åŒï¼Œç§»é™¤ API ç›¸é—œæ¨£å¼) ------ */
        :root {
            --primary: #4f46e5;     /* ä¸»è‰²èª¿ï¼šé›è— */
            --bg: #f8fafc;          /* èƒŒæ™¯è‰² */
            --surface: #ffffff;     /* å¡ç‰‡èƒŒæ™¯ */
            --text: #1e293b;        /* æ–‡å­—è‰² */
            --grade-bg: #eef2ff;    /* ä¸­æ–‡åˆ†æ•¸èƒŒæ™¯ */
            --grade-text: #3730a3;  /* ä¸­æ–‡åˆ†æ•¸æ–‡å­— */
        }

        body {
            font-family: 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        .app-container {
            background: var(--surface);
            width: 100%;
            max-width: 420px;
            padding: 2rem;
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            text-align: center;
            transition: all 0.3s ease;
        }

        h1 { margin-top: 0; font-size: 1.5rem; color: #0f172a; }

        /* 1. ä¸Šå‚³å€å¡Š */
        .upload-zone {
            border: 2px dashed #cbd5e1;
            border-radius: 16px;
            padding: 3rem 1rem;
            cursor: pointer;
            transition: 0.2s;
            background: #fff;
        }
        .upload-zone:hover {
            border-color: var(--primary);
            background: #f1f5f9;
        }
        .upload-icon { font-size: 3rem; margin-bottom: 1rem; display: block; }
        #fileInput { display: none; }

        /* 2. è¼‰å…¥å‹•ç•« */
        .loading-zone {
            display: none;
            padding: 2rem 0;
        }
        .spinner {
            width: 40px; height: 40px;
            border: 4px solid #e2e8f0;
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* 3. çµæœå±•ç¤ºå€ (ç…§ç‰‡+åˆ†æ•¸) */
        .result-zone {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* ç…§ç‰‡å®¹å™¨ */
        .image-wrapper {
            width: 100%;
            margin-bottom: -40px;
            position: relative;
            z-index: 1;
        }
        .preview-img {
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: block;
        }

        /* åˆ†æ•¸åœ“åœˆ + ä¸­æ–‡åˆ†æ•¸å®¹å™¨ */
        .score-wrapper {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 1rem;
        }
        .score-circle {
            width: 100px; height: 100px; border-radius: 50%;
            background: conic-gradient(var(--primary) 0%, #e2e8f0 0%);
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); background-color: white;
        }
        .score-val { font-size: 2.2rem; font-weight: 800; color: var(--primary); line-height: 1; }
        
        /* ä¸­æ–‡åˆ†æ•¸æ¨£å¼ */
        .grade-display {
            margin-top: 15px; padding: 8px 18px;
            background: var(--grade-bg); color: var(--grade-text);
            border-radius: 20px; font-size: 1.2rem;
            font-weight: 700; letter-spacing: 1px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }

        /* è©•èª */
        .comment-box {
            background: #f1f5f9; padding: 1rem; border-radius: 12px;
            margin-bottom: 1.5rem; text-align: left; font-size: 0.95rem;
            line-height: 1.6; color: #334155;
        }

        /* æŒ‰éˆ•ç¾¤ */
        .btn-group { display: flex; gap: 10px; }
        .btn { flex: 1; padding: 12px; border: none; border-radius: 10px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: 0.2s; }
        .btn-share { background: var(--primary); color: white; }
        .btn-retry { background: #e2e8f0; color: #475569; }
        .btn:active { transform: scale(0.96); }
    </style>
</head>
<body>

    <div class="app-container">
        <h1>ğŸ“¸ æ¨¡æ“¬æ”å½±è©•åˆ†</h1>

        <div class="upload-zone" id="uploadZone" onclick="document.getElementById('fileInput').click()">
            <span class="upload-icon">â˜ï¸</span>
            <p><strong>é»æ“Šä¸Šå‚³ç…§ç‰‡</strong></p>
            <p style="font-size:0.8rem; color:#94a3b8">çµæœç‚ºæ¨¡æ“¬äº‚æ•¸</p>
            <input type="file" id="fileInput" accept="image/*" onchange="processImage(event)">
        </div>

        <div class="loading-zone" id="loadingZone">
            <div class="spinner"></div>
            <p>æ­£åœ¨è¨ˆç®—åˆ†æ•¸...</p>
        </div>

        <div class="result-zone" id="resultZone">
            <div class="image-wrapper">
                <img id="displayImage" class="preview-img" src="" alt="User Photo">
            </div>

            <div class="score-wrapper">
                <div class="score-circle" id="scoreCircleBg">
                    <div class="score-inner">
                        <span class="score-val" id="scoreText">0</span>
                        <span class="score-label">åˆ†æ•¸</span>
                    </div>
                </div>
                
                <div class="grade-display" id="chineseGradeDisplay">--</div>
            </div>

            <div class="comment-box">
                <strong style="color:var(--primary)">ğŸ§  æ¨¡æ“¬è©•èªï¼š</strong><br>
                <span id="commentText">è©•èªè¼‰å…¥ä¸­...</span>
            </div>

            <div class="btn-group">
                <button class="btn btn-share" onclick="shareResult()">ğŸ“¤ åˆ†äº«åˆ†æ•¸</button>
                <button class="btn btn-retry" onclick="resetApp()">ğŸ”„ ä¸Šè¨´ (é‡æ¸¬)</button>
            </div>
        </div>
    </div>

    <script>
        // ------ JavaScript é‚è¼¯ ------

        // 1. ä¸­æ–‡åˆ†æ•¸è½‰æ›é‚è¼¯ (ä¿ç•™)
        function getChineseGrade(score) {
            if (score >= 95) return 'ç”²ä¸Š';
            if (score >= 90) return 'ç”²';
            if (score >= 85) return 'ç”²ä¸‹';
            if (score >= 80) return 'ä¹™ä¸Š';
            if (score >= 75) return 'ä¹™';
            if (score >= 70) return 'ä¹™ä¸‹';
            return 'ä¸™';
        }

        // 2. æ¨¡æ“¬è©•èª (æ–°å¢)
        function getSimulatedComment(score) {
            if (score >= 95) return "å®Œç¾çš„å…‰ç·šæŒæ§ï¼é€™å¼µç…§ç‰‡ç°¡ç›´æ˜¯è—è¡“å“ï¼Œè«‹æ”¶ä¸‹ç”²ä¸Šçš„æœ€é«˜è©•åƒ¹ï¼";
            if (score >= 90) return "æ§‹åœ–èˆ‡è‰²å½©å”èª¿å®Œç¾ï¼Œå·²ç¶“å…·å‚™å°ˆæ¥­ç´šæ°´æº–ã€‚";
            if (score >= 80) return "è¦–è¦ºæ•ˆæœè‰¯å¥½ï¼Œä½†ç´°ç¯€è™•ç†ä¸Šé‚„æœ‰æå‡ç©ºé–“ã€‚";
            if (score >= 70) return "æ„å¢ƒä¸éŒ¯ï¼Œä½†æ›å…‰æˆ–å°ç„¦ç•¥æœ‰ä¸è¶³ï¼Œä¸‹æ¬¡æœƒæ›´å¥½ã€‚";
            return "å—¯... è—è¡“æ˜¯å¾ˆä¸»è§€çš„ï¼Œæˆ‘å€‘ä¸‹æ¬¡å†è©¦è©¦åˆ¥çš„è§’åº¦ï¼Ÿ";
        }


        // 3. è™•ç†åœ–ç‰‡èˆ‡æ¨¡æ“¬è©•åˆ† (å–ä»£ API å‘¼å«)
        async function processImage(event) {
            const file = event.target.files[0];
            if (!file) return;

            // UI åˆ‡æ›ï¼šé¡¯ç¤º Loading
            document.getElementById('uploadZone').style.display = 'none';
            document.getElementById('loadingZone').style.display = 'block';

            // åœ–ç‰‡é è¦½
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('displayImage').src = e.target.result;

                // æ¨¡æ“¬è™•ç†æ™‚é–“ (2ç§’)
                setTimeout(() => {
                    // --- æ ¸å¿ƒï¼šç”¢ç”Ÿéš¨æ©Ÿåˆ†æ•¸ (0-100) ---
                    const score = Math.floor(Math.random() * 101); 
                    
                    const aiResult = {
                        score: score,
                        comment: getSimulatedComment(score)
                    };

                    showResult(aiResult);
                }, 2000); 
            };
            reader.readAsDataURL(file);
        }
        
        // 4. é¡¯ç¤ºçµæœå‹•ç•« (èˆ‡ä¸Šæ¬¡ç›¸åŒï¼Œåªç§»é™¤ API ç›¸é—œè¨­å®š)
        function showResult(data) {
            document.getElementById('loadingZone').style.display = 'none';
            document.getElementById('resultZone').style.display = 'block';

            const score = data.score;
            const chineseGrade = getChineseGrade(score);

            document.getElementById('scoreText').innerText = score;
            document.getElementById('chineseGradeDisplay').innerText = chineseGrade;
            document.getElementById('commentText').innerText = data.comment;

            // åœ“ç’°é¡è‰²èˆ‡æ¨£å¼
            let color = '#ef4444'; // ä¸™
            if (score >= 70) color = '#f59e0b'; // ä¹™ç³»åˆ—
            if (score >= 85) color = '#4f46e5'; // ç”²ç³»åˆ—
            
            document.getElementById('scoreText').style.color = color;
            document.getElementById('chineseGradeDisplay').style.background = color + '20';
            document.getElementById('chineseGradeDisplay').style.color = color;
            
            const deg = score * 3.6;
            document.getElementById('scoreCircleBg').style.background = 
                `conic-gradient(${color} ${deg}deg, #e2e8f0 0deg)`;
        }

        // 5. åˆ†äº«åŠŸèƒ½ (èˆ‡ä¸Šæ¬¡ç›¸åŒ)
        async function shareResult() {
            const score = document.getElementById('scoreText').innerText;
            const grade = document.getElementById('chineseGradeDisplay').innerText;
            const comment = document.getElementById('commentText').innerText;
            
            const shareData = {
                title: 'æ¨¡æ“¬æ”å½±è©•åˆ†çµæœ',
                text: `æˆ‘çš„ç…§ç‰‡ç²å¾— ${score} åˆ† (${grade})ï¼è©•èªï¼šã€Œ${comment}ã€`,
                url: window.location.href
            };

            if (navigator.share) {
                try { await navigator.share(shareData); } catch (e) {}
            } else {
                navigator.clipboard.writeText(`${shareData.text} ${shareData.url}`);
                alert('çµæœå·²è¤‡è£½ï¼å¿«å»è²¼çµ¦æœ‹å‹çœ‹ï¼');
            }
        }

        // 6. é‡ç½® (ä¸Šè¨´)
        function resetApp() {
            document.getElementById('resultZone').style.display = 'none';
            document.getElementById('loadingZone').style.display = 'none';
            document.getElementById('uploadZone').style.display = 'block';
            document.getElementById('fileInput').value = '';
        }
    </script>
</body>
</html>
